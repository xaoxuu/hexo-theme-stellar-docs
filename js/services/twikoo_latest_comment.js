utils.jq(()=>{$(function(){const a=document.querySelector(".ds-twikoo");utils.onLoading(a);var e=a.getAttribute("api"),t=parseInt(a.getAttribute("limit"))||10,i="reply"!==a.getAttribute("hide");e&&fetch(e,{method:"POST",body:JSON.stringify({event:"GET_RECENT_COMMENTS",envId:e,pageSize:t,includeReply:i}),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(({data:e})=>{utils.onLoadSuccess(a),e.forEach((e,t)=>{let i=e.commentText;i&&""!==i.trim()&&(i=50<(i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")).length?i.substring(0,50)+"...":i,t=(t=(t=(t=(t='<div class="timenode" index="'+t+'"><div class="header"><div class="user-info">')+"<span>"+e.nick+"</span></div>")+"<span>"+new Date(e.created).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})+"</span>")+'</div><a class="body" href="'+e.url+"#"+e.id+'">')+i+"</a></div>",$(a).append(t))})}).catch(()=>utils.onLoadFailure(a))})});